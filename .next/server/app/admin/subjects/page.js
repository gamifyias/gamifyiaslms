(()=>{var e={};e.id=796,e.ids=[796],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},3882:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>n.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>o,routeModule:()=>x,tree:()=>c}),t(763),t(1506),t(5866);var i=t(3191),a=t(8716),r=t(7922),n=t.n(r),l=t(5231),d={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>l[e]);t.d(s,d);let c=["",{children:["admin",{children:["subjects",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,763)),"D:\\PROJECTS\\GAMIFY IAS LMS\\V0 LATEST\\app\\admin\\subjects\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,1506)),"D:\\PROJECTS\\GAMIFY IAS LMS\\V0 LATEST\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,5866,23)),"next/dist/client/components/not-found-error"]}],o=["D:\\PROJECTS\\GAMIFY IAS LMS\\V0 LATEST\\app\\admin\\subjects\\page.tsx"],u="/admin/subjects/page",m={require:t,loadChunk:()=>Promise.resolve()},x=new i.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/admin/subjects/page",pathname:"/admin/subjects",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},9085:(e,s,t)=>{Promise.resolve().then(t.bind(t,4569))},4569:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>_,dynamic:()=>y});var i=t(326),a=t(7577),r=t(2945),n=t(2086),l=t(4008),d=t(2643),c=t(772),o=t(4432),u=t(7673),m=t(2288),x=t(9440),h=t(7506),p=t(3855),j=t(6343),f=t(4389),g=t(8091),v=t(8393),b=t(9183),N=t(6283);let y="force-dynamic";function _(){let e=(0,r.e)(),{toast:s}=(0,l.pm)(),[t,y]=(0,a.useState)(!0),[_,w]=(0,a.useState)([]),[C,S]=(0,a.useState)(null),[A,I]=(0,a.useState)({}),[T,Z]=(0,a.useState)({}),[E,z]=(0,a.useState)(null),[M,P]=(0,a.useState)({name:"",description:""}),[q,D]=(0,a.useState)(null),[k,O]=(0,a.useState)({subjectId:"",name:"",description:""}),[L,R]=(0,a.useState)(null),[V,G]=(0,a.useState)({topicId:"",title:"",content_type:"video",resource_url:"",duration_minutes:""}),[$,Y]=(0,a.useState)("create"),F=async t=>{try{let{data:s}=await e.from("topics").select("id, name, description, order_index").eq("subject_id",t).order("order_index",{ascending:!0}),i=s||[];if(I(e=>({...e,[t]:i})),0===i.length)return;let a=i.map(e=>e.id),{data:r}=await e.from("study_materials").select("*").in("topic_id",a),n={};(r||[]).forEach(e=>{n[e.topic_id]||(n[e.topic_id]=[]),n[e.topic_id].push(e)}),Z(e=>({...e,...n}))}catch{s({title:"Error",description:"Failed to load topics or materials.",variant:"destructive"})}},K=async()=>{if(!M.name.trim())return;let{data:t,error:i}=await e.from("subjects").insert({name:M.name,description:M.description||null}).select().single();if(i)return s({title:"Error",description:i.message,variant:"destructive"});w(e=>[...e,t]),P({name:"",description:""}),s({title:"Subject Added"})},J=async()=>{if(!q)return;let{id:t,name:i,description:a}=q,{data:r,error:n}=await e.from("subjects").update({name:i,description:a}).eq("id",t).select().single();if(n)return s({title:"Error",description:n.message,variant:"destructive"});w(e=>e.map(e=>e.id===t?r:e)),D(null),s({title:"Subject Updated"})},U=async t=>{let{error:i}=await e.from("subjects").delete().eq("id",t);if(i)return s({title:"Error",description:i.message,variant:"destructive"});w(e=>e.filter(e=>e.id!==t)),s({title:"Subject Deleted"})},W=async()=>{let{subjectId:t,name:i,description:a}=k;if(!t||!i.trim())return;let r=A[t]||[],n=r.length,{data:l,error:d}=await e.from("topics").insert({subject_id:t,name:i,description:a||null,order_index:n}).select().single();if(d)return s({title:"Error",description:d.message,variant:"destructive"});I(e=>({...e,[t]:[...r,l]})),O({subjectId:"",name:"",description:""}),s({title:"Topic Added"})},X=async()=>{if(!L)return;let{subjectId:t,topic:i}=L,{id:a,name:r,description:n}=i,{data:l,error:d}=await e.from("topics").update({name:r,description:n||null}).eq("id",a).select().single();if(d)return s({title:"Error",description:d.message,variant:"destructive"});I(e=>({...e,[t]:e[t].map(e=>e.id===a?l:e)})),R(null),s({title:"Topic Updated"})},B=async(t,i)=>{let{error:a}=await e.from("topics").delete().eq("id",i);if(a)return s({title:"Error",description:a.message,variant:"destructive"});I(e=>({...e,[t]:e[t].filter(e=>e.id!==i)})),s({title:"Topic Deleted"})},H=async()=>{let t,i;let{id:a,topicId:r,title:n,content_type:l,resource_url:d,duration_minutes:c}=V;if(r&&n.trim()){if("create"===$){let s=await e.from("study_materials").insert({topic_id:r,title:n,content_type:l,resource_url:d,duration_minutes:c?Number(c):null,created_by:E}).select().single();t=s.data,i=s.error}else{let s=await e.from("study_materials").update({title:n,content_type:l,resource_url:d,duration_minutes:c?Number(c):null}).eq("id",a).select().single();t=s.data,i=s.error}if(i)return s({title:"Error",description:i.message,variant:"destructive"});Z(e=>{let s=e[r]||[];return"create"===$?{...e,[r]:[...s,t]}:{...e,[r]:s.map(e=>e.id===t.id?t:e)}}),s({title:"create"===$?"Material Added":"Material Updated"}),G({topicId:"",title:"",content_type:"video",resource_url:"",duration_minutes:""})}},Q=async(t,i)=>{let{error:a}=await e.from("study_materials").delete().eq("id",i);if(a)return s({title:"Error",description:a.message,variant:"destructive"});Z(e=>({...e,[t]:e[t].filter(e=>e.id!==i)})),s({title:"Material Deleted"})};return t?(0,i.jsxs)("div",{className:"flex h-screen",children:[i.jsx(n.AdminSidebar,{}),i.jsx("div",{className:"flex-1 flex justify-center items-center",children:i.jsx(h.Z,{className:"w-8 h-8 animate-spin"})})]}):(0,i.jsxs)("div",{className:"flex h-screen",children:[i.jsx(n.AdminSidebar,{}),(0,i.jsxs)("div",{className:"flex-1 overflow-auto p-8 max-w-5xl mx-auto",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,i.jsxs)("div",{children:[i.jsx("h1",{className:"text-3xl font-bold",children:"Admin: Subjects, Topics & Materials"}),i.jsx("p",{className:"text-muted-foreground mt-1",children:"Administrators can fully manage subjects, topics, and materials."})]}),(0,i.jsxs)(m.Vq,{children:[i.jsx(m.hg,{asChild:!0,children:(0,i.jsxs)(c.z,{className:"gap-2",children:[i.jsx(p.Z,{className:"w-4 h-4"}),"Add Subject"]})}),(0,i.jsxs)(m.cZ,{children:[i.jsx(m.fK,{children:i.jsx(m.$N,{children:"Add New Subject"})}),(0,i.jsxs)("div",{className:"space-y-4",children:[i.jsx(o.I,{placeholder:"Subject Name",value:M.name,onChange:e=>P(s=>({...s,name:e.target.value}))}),i.jsx(u.g,{placeholder:"Description (optional)",value:M.description,onChange:e=>P(s=>({...s,description:e.target.value}))}),i.jsx(c.z,{className:"w-full",onClick:K,children:"Add Subject"})]})]})]})]}),i.jsx("div",{className:"space-y-6",children:_.map(e=>{let s=C===e.id,t=A[e.id]||[];return(0,i.jsxs)(d.Zb,{className:"hover:shadow-md transition-shadow",children:[i.jsx(d.Ol,{className:"cursor-pointer",onClick:()=>{let t=!s;S(t?e.id:null),t&&!A[e.id]&&F(e.id)},children:(0,i.jsxs)("div",{className:"flex justify-between items-center",children:[(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[i.jsx(j.Z,{className:"w-5 h-5"}),i.jsx(d.ll,{className:"text-xl",children:e.name})]}),e.description&&i.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:e.description})]}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsxs)(m.Vq,{open:q?.id===e.id,onOpenChange:s=>{s?D(e):D(null)},children:[i.jsx(m.hg,{asChild:!0,onClick:e=>e.stopPropagation(),children:i.jsx(c.z,{size:"icon",variant:"outline",children:i.jsx(f.Z,{className:"w-4 h-4"})})}),(0,i.jsxs)(m.cZ,{children:[i.jsx(m.fK,{children:i.jsx(m.$N,{children:"Edit Subject"})}),(0,i.jsxs)("div",{className:"space-y-4",children:[i.jsx(o.I,{value:q?.name||"",onChange:e=>D(s=>s?{...s,name:e.target.value}:s)}),i.jsx(u.g,{value:q?.description||"",onChange:e=>D(s=>s?{...s,description:e.target.value}:s)}),i.jsx(c.z,{className:"w-full",onClick:J,children:"Save Changes"})]})]})]}),(0,i.jsxs)(x.aR,{children:[i.jsx(x.vW,{asChild:!0,onClick:e=>e.stopPropagation(),children:i.jsx(c.z,{size:"icon",variant:"outline",children:i.jsx(g.Z,{className:"w-4 h-4 text-red-600"})})}),(0,i.jsxs)(x._T,{children:[(0,i.jsxs)(x.fY,{children:[i.jsx(x.f$,{children:"Delete Subject?"}),i.jsx(x.yT,{children:"This will permanently delete the subject."})]}),(0,i.jsxs)(x.xo,{children:[i.jsx(x.le,{children:"Cancel"}),i.jsx(x.OL,{className:"bg-red-600 hover:bg-red-700",onClick:()=>U(e.id),children:"Delete"})]})]})]}),s?i.jsx(v.Z,{className:"w-5 h-5"}):i.jsx(b.Z,{className:"w-5 h-5"})]})]})}),s&&(0,i.jsxs)(d.aY,{className:"space-y-4",children:[(0,i.jsxs)(m.Vq,{open:k.subjectId===e.id,onOpenChange:s=>{s?O({subjectId:e.id,name:"",description:""}):O({subjectId:"",name:"",description:""})},children:[i.jsx(m.hg,{asChild:!0,children:(0,i.jsxs)(c.z,{size:"sm",className:"gap-2",children:[i.jsx(p.Z,{className:"w-4 h-4"}),"Add Topic"]})}),(0,i.jsxs)(m.cZ,{children:[i.jsx(m.fK,{children:(0,i.jsxs)(m.$N,{children:["Add Topic to ",e.name]})}),(0,i.jsxs)("div",{className:"space-y-4",children:[i.jsx(o.I,{placeholder:"Topic Name",value:k.subjectId===e.id?k.name:"",onChange:s=>O({subjectId:e.id,name:s.target.value,description:k.description})}),i.jsx(u.g,{placeholder:"Description (optional)",value:k.subjectId===e.id?k.description:"",onChange:s=>O({subjectId:e.id,name:k.name,description:s.target.value})}),i.jsx(c.z,{className:"w-full",onClick:W,children:"Add Topic"})]})]})]}),i.jsx("div",{className:"space-y-3 mt-2",children:0===t.length?i.jsx("p",{className:"text-sm text-muted-foreground",children:"No topics added yet."}):t.map(s=>{let t=T[s.id]||[];return(0,i.jsxs)("div",{className:"border rounded-lg p-4 space-y-3",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center",children:[(0,i.jsxs)("div",{children:[i.jsx("p",{className:"font-semibold",children:s.name}),s.description&&i.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:s.description})]}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsxs)(m.Vq,{open:L?.topic.id===s.id,onOpenChange:t=>{t?R({subjectId:e.id,topic:{...s}}):R(null)},children:[i.jsx(m.hg,{asChild:!0,children:i.jsx(c.z,{size:"icon",variant:"outline",children:i.jsx(f.Z,{className:"w-4 h-4"})})}),(0,i.jsxs)(m.cZ,{children:[i.jsx(m.fK,{children:i.jsx(m.$N,{children:"Edit Topic"})}),(0,i.jsxs)("div",{className:"space-y-4",children:[i.jsx(o.I,{placeholder:"Topic Name",value:L?.topic.name||"",onChange:e=>R(s=>s?{...s,topic:{...s.topic,name:e.target.value}}:s)}),i.jsx(u.g,{placeholder:"Description",value:L?.topic.description||"",onChange:e=>R(s=>s?{...s,topic:{...s.topic,description:e.target.value}}:s)}),i.jsx(c.z,{className:"w-full",onClick:X,children:"Save Changes"})]})]})]}),(0,i.jsxs)(x.aR,{children:[i.jsx(x.vW,{asChild:!0,children:i.jsx(c.z,{size:"icon",variant:"outline",children:i.jsx(g.Z,{className:"w-4 h-4 text-red-600"})})}),(0,i.jsxs)(x._T,{children:[(0,i.jsxs)(x.fY,{children:[i.jsx(x.f$,{children:"Delete Topic?"}),i.jsx(x.yT,{children:"This will delete the topic."})]}),(0,i.jsxs)(x.xo,{children:[i.jsx(x.le,{children:"Cancel"}),i.jsx(x.OL,{className:"bg-red-600 hover:bg-red-700",onClick:()=>B(e.id,s.id),children:"Delete"})]})]})]})]})]}),(0,i.jsxs)("div",{className:"flex justify-between items-center mt-2",children:[i.jsx("p",{className:"text-xs font-semibold text-muted-foreground",children:"Study Materials"}),(0,i.jsxs)(m.Vq,{open:"create"===$&&V.topicId===s.id,onOpenChange:e=>{e?(Y("create"),G({topicId:s.id,title:"",content_type:"video",resource_url:"",duration_minutes:""})):G({topicId:"",title:"",content_type:"video",resource_url:"",duration_minutes:""})},children:[i.jsx(m.hg,{asChild:!0,children:(0,i.jsxs)(c.z,{size:"sm",variant:"outline",className:"gap-1",children:[i.jsx(p.Z,{className:"w-4 h-4"}),"Add Material"]})}),(0,i.jsxs)(m.cZ,{children:[i.jsx(m.fK,{children:(0,i.jsxs)(m.$N,{children:["Add Material to ",s.name]})}),(0,i.jsxs)("div",{className:"space-y-4",children:[i.jsx(o.I,{placeholder:"Title",value:V.title,onChange:e=>G(s=>({...s,title:e.target.value}))}),i.jsx(o.I,{placeholder:"Resource URL",value:V.resource_url,onChange:e=>G(s=>({...s,resource_url:e.target.value}))}),i.jsx(o.I,{placeholder:"Duration (minutes)",type:"number",value:V.duration_minutes,onChange:e=>G(s=>({...s,duration_minutes:e.target.value}))}),i.jsx(o.I,{placeholder:"Content Type (video/pdf/notes/test)",value:V.content_type,onChange:e=>G(s=>({...s,content_type:e.target.value}))}),i.jsx(c.z,{className:"w-full",onClick:H,children:"Save Material"})]})]})]})]}),i.jsx("div",{className:"space-y-2 mt-2",children:0===t.length?i.jsx("p",{className:"text-xs text-muted-foreground",children:"No materials added for this topic yet."}):t.map(e=>(0,i.jsxs)("div",{className:"flex items-center justify-between border rounded-md px-3 py-2 text-sm",children:[(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[i.jsx(N.Z,{className:"w-4 h-4 text-muted-foreground"}),i.jsx("span",{className:"font-medium",children:e.title})]}),(0,i.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:[e.content_type," â€¢"," ",e.duration_minutes?`${e.duration_minutes} min`:"no duration"]})]}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsxs)(m.Vq,{open:"edit"===$&&V.id===e.id,onOpenChange:s=>{s?(Y("edit"),G({topicId:e.topic_id,id:e.id,title:e.title,content_type:e.content_type,resource_url:e.resource_url,duration_minutes:e.duration_minutes?.toString()||""})):G({topicId:"",title:"",content_type:"video",resource_url:"",duration_minutes:""})},children:[i.jsx(m.hg,{asChild:!0,children:i.jsx(c.z,{size:"icon",variant:"outline",children:i.jsx(f.Z,{className:"w-4 h-4"})})}),(0,i.jsxs)(m.cZ,{children:[i.jsx(m.fK,{children:i.jsx(m.$N,{children:"Edit Material"})}),(0,i.jsxs)("div",{className:"space-y-4",children:[i.jsx(o.I,{value:V.title,onChange:e=>G(s=>({...s,title:e.target.value}))}),i.jsx(o.I,{value:V.resource_url,onChange:e=>G(s=>({...s,resource_url:e.target.value}))}),i.jsx(o.I,{type:"number",value:V.duration_minutes,onChange:e=>G(s=>({...s,duration_minutes:e.target.value}))}),i.jsx(o.I,{value:V.content_type,onChange:e=>G(s=>({...s,content_type:e.target.value}))}),i.jsx(c.z,{className:"w-full",onClick:H,children:"Save Changes"})]})]})]}),(0,i.jsxs)(x.aR,{children:[i.jsx(x.vW,{asChild:!0,children:i.jsx(c.z,{size:"icon",variant:"outline",children:i.jsx(g.Z,{className:"w-4 h-4 text-red-600"})})}),(0,i.jsxs)(x._T,{children:[(0,i.jsxs)(x.fY,{children:[i.jsx(x.f$,{children:"Delete Material?"}),i.jsx(x.yT,{children:"This will permanently remove the study material."})]}),(0,i.jsxs)(x.xo,{children:[i.jsx(x.le,{children:"Cancel"}),i.jsx(x.OL,{className:"bg-red-600 hover:bg-red-700",onClick:()=>Q(s.id,e.id),children:"Delete"})]})]})]})]})]},e.id))})]},s.id)})})]})]},e.id)})})]})]})}},2086:(e,s,t)=>{"use strict";t.d(s,{AdminSidebar:()=>f});var i=t(326),a=t(434),r=t(5047),n=t(7577),l=t(2945),d=t(4319),c=t(4909),o=t(4061),u=t(6343),m=t(3634),x=t(9635),h=t(1810),p=t(772),j=t(7863);function f(){let e=(0,r.usePathname)(),s=(0,r.useRouter)(),t=(0,l.e)(),[f,g]=(0,n.useState)(null),[v,b]=(0,n.useState)(null),N=async()=>{await t.auth.signOut(),s.push("/auth/login")},y=[{icon:d.Z,label:"Admin Dashboard",href:"/admin/dashboard"},{icon:c.Z,label:"User Management",href:"/admin/users"},{icon:o.Z,label:"Mentors",href:"/admin/mentors"},{icon:u.Z,label:"Subjects & Topics",href:"/admin/subjects"}];return(0,i.jsxs)("div",{className:"hidden md:flex flex-col w-64 bg-sidebar border-r border-sidebar-border h-screen",children:[(0,i.jsxs)("div",{className:"p-6 border-b border-sidebar-border",children:[(0,i.jsxs)(a.default,{href:"/admin/dashboard",className:"flex items-center gap-2",children:[i.jsx("div",{className:"w-8 h-8 rounded-lg bg-gradient-to-r from-primary to-red-500 flex items-center justify-center",children:i.jsx(m.Z,{className:"w-5 h-5 text-white"})}),(0,i.jsxs)("div",{children:[i.jsx("h1",{className:"font-bold text-sidebar-foreground",children:"Gamify IAS Academy"}),i.jsx("p",{className:"text-xs text-sidebar-accent",children:"Admin Panel"})]})]}),(0,i.jsxs)("div",{className:"mt-4 flex items-center gap-3",children:[v?i.jsx("img",{src:v,alt:f??"Admin",className:"w-10 h-10 rounded-full object-cover"}):i.jsx("div",{className:"w-10 h-10 rounded-full bg-muted flex items-center justify-center",children:i.jsx(x.Z,{className:"w-5 h-5"})}),(0,i.jsxs)("a",{href:"/admin/settings",className:"block w-full text-left",children:[i.jsx("div",{className:"text-sm font-medium",children:f??"Admin"}),i.jsx("div",{className:"text-xs text-muted-foreground",children:"Administrator"})]})]})]}),i.jsx("nav",{className:"flex-1 p-4 space-y-2 overflow-y-auto",children:y.map(s=>{let t=s.icon,r=e===s.href||e.startsWith(s.href+"/");return i.jsx(a.default,{href:s.href,children:(0,i.jsxs)(p.z,{variant:r?"default":"ghost",className:(0,j.cn)("w-full justify-start gap-3",r&&"bg-sidebar-primary text-sidebar-primary-foreground"),children:[i.jsx(t,{className:"w-4 h-4"}),s.label]})},s.href)})}),i.jsx("div",{className:"p-4 border-t border-sidebar-border space-y-2",children:(0,i.jsxs)(p.z,{onClick:N,variant:"outline",className:"w-full justify-start gap-2 bg-transparent",children:[i.jsx(h.Z,{className:"w-4 h-4"}),"Logout"]})})]})}},763:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>r,dynamic:()=>a});var i=t(8570);let a=(0,i.createProxy)(String.raw`D:\PROJECTS\GAMIFY IAS LMS\V0 LATEST\app\admin\subjects\page.tsx#dynamic`),r=(0,i.createProxy)(String.raw`D:\PROJECTS\GAMIFY IAS LMS\V0 LATEST\app\admin\subjects\page.tsx#default`)}};var s=require("../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),i=s.X(0,[669,399,404,186,777,380],()=>t(3882));module.exports=i})();